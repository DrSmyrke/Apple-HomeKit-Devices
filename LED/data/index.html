<!DOCTYPE html>
<html lang="en">
	<head>
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta charset="utf-8"/>
		<META http-equiv="Pragma" content="no-cache">
		<link rel=stylesheet type="text/css" href="/index.css"/>
		<script type="text/javascript" src="/index.js"></script>
		<title>-= LED Control Panel =-</title>
	</head>
	<body>
		<header>
			<div class="logo">LED Control Panel</div>
			<div class="menu">
				<a href="/" class="button">Home</a>
				<a href="/wifi" class="button">Wifi Settings</a>
				<a href="/sysinfo" class="button">System info</a>
			</div>
		</header>
		<hr>
		<div class="content">
			<form method="POST" target="/" name="onoff">
				<input type="hidden" name="onoff">
				<div class="legend">LED On/Off</div>
				<div class="block">
					<div class="string">
						<text>On/Off:</text>
						<input type="checkbox" name="show" onChange="dev_action( this.checked );">
					</div>
				</div>
			</form>
			<form method="POST" target="/" name="hsb">
				<div class="legend">LED Configure</div>
				<div class="block">
					<div class="string">
						<text>HUE:</text>
						<input type="range" name="hue" min="0" max="359" class="sliderHUE" onInput="updateHSB();">
					</div>
					<div class="string">
						<text>Saturation:</text>
						<input type="range" name="sat" min="0" max="100" class="sliderSaturation" onInput="updateHSB();">
					</div>
					<div class="string">
						<text>Brightness:</text>
						<input type="range" name="bri" min="0" max="100" class="sliderBrightness" onInput="updateHSB();">
					</div>
				</div>
			</form>





<script type="text/javascript">
window.onload = function(){
	formRequest.open( 'GET', '/get', true );
	formRequest.send( null );

	formRequest.onreadystatechange = function(){
		if( formRequest.readyState == 4 && formRequest.status == 200 ){
			let dataObject = JSON.parse( ( formRequest.responseText != '' ) ? formRequest.responseText : '{}' );
			if( dataObject.hasOwnProperty( "on" ) ){
				document.forms.onoff.show.checked = ( dataObject.on ) ? true : false;
				document.forms.onoff.onoff.value = ( dataObject.on ) ? 1 : 0;
			}
			if( dataObject.hasOwnProperty( "hue" ) ){
				document.forms.hsb.hue.value = dataObject.hue;
			}
			if( dataObject.hasOwnProperty( "sat" ) ){
				document.forms.hsb.sat.value = dataObject.sat;
			}
			if( dataObject.hasOwnProperty( "bri" ) ){
				document.forms.hsb.bri.value = dataObject.bri;
			}
		}
	}
};

var timeout = 0;
function updateT()
{
	if( timeout > 0 ){
		timeout--;
		setTimeout( updateT, 10 );
	}else{
		let form = document.forms.hsb;
		
		let formData = new FormData( form );
		formRequest.open( "POST", form.action, false );
		formRequest.send( formData );
	}
}

function updateHSB()
{
	if( timeout <= 0 ){
		timeout = 25;
		updateT();
	}else{
		timeout = 25;
	}
}

function dev_action( value )
{
	let form = document.forms.onoff;

	form.onoff.value = ( value == true ) ? 1 : 0;
	
	let formData = new FormData( form );
	formRequest.open( "POST", form.action, false );
	formRequest.send( formData );
}
</script>
<style>
	:root{
	--slider-border: 2px solid black;
	--slider-track-height: 15px;
}

input[type=range]{
	-webkit-appearance: none;
	height: 15px;
	width: calc( 100% - 115px );
	padding: 0px;
}

.sliderNumber{
	width: 48px;
	background: none;
	color: black;
	border: 1px solid silver;
	border-width: 0px 0px 1px 0px;
}

input[type=range]::-moz-range-track{ height: var(--slider-track-height); }
input[type=range]::-ms-track{ height: var(--slider-track-height); }
input[type=range]::-webkit-slider-runnable-track{ height: var(--slider-track-height); }

input[type=range]::-moz-range-thumb{
	background-color: rgba( 100, 100, 100, 0.4 );
	border: var(--slider-border);
	border-radius: 0px;
	width: 7px;
}

/* Специальные правила для браузеров на движках WebKit/Blink */
input[type=range]::-webkit-slider-thumb{
	-webkit-appearance: none;
	background-color: rgba( 100, 100, 100, 0.4 );
	border: var(--slider-border);
	border-radius: 0px;
	width: 7px;
	height: 16px;
}


.sliderBox{
	display: flex;
	justify-content: space-between;
	align-items: center;
}

.sliderBox .contentBox{
	width: calc( 100% - 64px );
}

.sliderBox .previewBox{
	width: 48px;
	height: 48px;
	background-color: rgba( 100, 100, 100 );
}


.sliderHUE::-moz-range-track{
	background: linear-gradient( to right, #DB2C2C, #DADB2C, #43DB2C, #2C50DB, #CD2CDB, #DB322C );
}
.sliderHUE::-ms-track{
	background: linear-gradient( to right, #DB2C2C, #DADB2C, #43DB2C, #2C50DB, #CD2CDB, #DB322C );
}
.sliderHUE::-webkit-slider-runnable-track{
	background: linear-gradient( to right, #DB2C2C, #DADB2C, #43DB2C, #2C50DB, #CD2CDB, #DB322C );
}



.sliderSaturation::-moz-range-track{
	background: linear-gradient( to right, #FFFFFF, #000000 );
}
.sliderSaturation::-ms-track{
	background: linear-gradient( to right, #FFFFFF, #000000 );
}
.sliderSaturation::-webkit-slider-runnable-track{
	background: linear-gradient( to right, #FFFFFF, #000000 );
}




.sliderBrightness::-moz-range-track{
	background: linear-gradient( to right, #000000, #FFFFFF );
}
.sliderBrightness::-ms-track{
	background: linear-gradient( to right, #000000, #FFFFFF );
}
.sliderBrightness::-webkit-slider-runnable-track{
	background: linear-gradient( to right, #000000, #FFFFFF );
}

	</style>

		</div>
		<hr>
		<footer>
			<div>Created by <a href="http://drsmyrke.ru" target="_blank">Dr.Smyrke</a></div>
			<div><i class="info">ООО "Шайтан технолоджи"</i></div>
			<div><i class="info">при поддержке ЗАО "Мутные схемы" и ОАО "Любовь в займы"</i></div>
		</footer>
	</body>
</html>
